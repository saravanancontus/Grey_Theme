<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Top menu for store
 *
 * @see Mage_Catalog_Block_Navigation
 */
?>
<?php
/**
 * $this->renderCategoriesMenuHtml() supports optional arguments:
 * int Level number for list item class to start from
 * string Extra class of outermost list items
 * string If specified wraps children list in div with this class
 */
?>
<?php $_menu = $this->renderCategoriesMenuHtml(0,'level-top') ?>
<?php if($_menu): ?>
<div class="nav-container">
    <ul id="nav">
        <?php echo $_menu ?>

        <script type="text/javascript">
                    //var jqs = jQuery.noConflict();
                    var str="";
                    var sum=0;
                    var i=1;
                    jqs(document).ready(function (){
                        jqs(".nav-container ul:not('.children') > li").each(function(){
                            if(jqs(this).width())
                            {
                                sum +=jqs(this).width();
                                if(sum > 500)
                                {

                                    str += "<li>"+ jqs(this).html()+ "</li>";

                                    if(i==1){
                                        jqs(this).wrap("<var id='MoreDiv' />")
                                    }
                                    else
                                    {
                                        jqs(this).wrap("<var class='ClearDiv' />")
                                    }
                                    i++;
                                }
                            }
                        });
                        str ="<li><a href='javascript:void(0);'>More</a><ul>"+str+"</ul></li>";
                        jqs("#MoreDiv").html(str);
                        jqs(".ClearDiv").html("");
                        jqs(".ClearDiv").remove();
                    });
                </script>



    </ul>
</div>
<?php endif ?>
